    <!DOCTYPE html>
    <html lang="pt-BR">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Interpretador Python</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/dracula.min.css">
        <style>
            :root {
                --clr-body-light: #fdfdfd;
                --clr-main-light: #ffffff;
                --clr-text-light: #111111;
                --clr-border-light: rgba(0, 0, 0, 0.15);
                --clr-editor-light: #f8f8f8;
                --clr-header-light: #e0e0e0;
                --clr-dots-light: #cccccc;
                --clr-example-bg-light: #f5f5f5;
                --clr-example-header-light: #e5e5e5;
                --clr-example-text-light: #333333;
                --clr-body-dark: #1e1e2f;
                --clr-main-dark: #2a2a3c;
                --clr-text-dark: #dcdcdc;
                --clr-border-dark: rgba(255, 255, 255, 0.1);
                --clr-editor-dark: #1e1e2f;
                --clr-header-dark: #2c2c3c;
                --clr-dots-dark: #555555;
                --clr-example-bg-dark: #2a2a3c;
                --clr-example-header-dark: #3a3a4c;
                --clr-example-text-dark: #dcdcdc;
                --bg-body: var(--clr-body-light);
                --bg-main: var(--clr-main-light);
                --text-color: var(--clr-text-light);
                --border-color: var(--clr-border-light);
                --bg-editor: var(--clr-editor-light);
                --bg-header: var(--clr-header-light);
                --bg-dots: var(--clr-dots-light);
                --bg-example: var(--clr-example-bg-light);
                --bg-example-header: var(--clr-example-header-light);
                --text-example: var(--clr-example-text-light);
            }

            body {
                font-family: 'Segoe UI', sans-serif;
                margin: 0;
                padding: 0;
                background-color: var(--bg-body);
                color: var(--text-color);
            }

            .container {
                max-width: 960px;
                margin: 40px auto;
                padding: 20px;
                background-color: var(--bg-main);
                border-radius: 16px;
                box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2);
                border: 1px solid var(--border-color);
            }

            #toggle-theme {
                position: fixed;
                top: 10px;
                right: 20px;
                background: none;
                border: none;
                font-size: 1.5em;
                cursor: pointer;
                transition: transform 0.2s;
                z-index: 1000;
            }

            #toggle-theme:hover {
                transform: scale(1.25);
            }

            .editor-container {
                background-color: var(--bg-editor);
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
                margin: 20px 0;
                border: 1px solid var(--border-color);
            }

            .code-header {
                background-color: var(--bg-header);
                color: var(--text-color);
                padding: 12px 20px;
                font-size: 14px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-family: monospace;
            }

            .code-header .dots {
                display: flex;
                gap: 6px;
            }

            .dot {
                width: 10px;
                height: 10px;
                border-radius: 50%;
                background-color: var(--bg-dots);
            }

            .dot.red {
                background-color: #ff5f56;
            }

            .dot.yellow {
                background-color: #ffbd2e;
            }

            .dot.green {
                background-color: #27c93f;
            }

            .CodeMirror {
                border: none;
                height: auto;
                font-size: 14px;
                background-color: var(--bg-editor);
                color: var(--text-color);
            }

            .output-container {
                background-color: var(--bg-editor);
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
                margin: 20px 0;
                padding: 20px;
                color: var(--text-color);
                font-family: 'Fira Code', monospace;
                font-size: 15px;
                line-height: 1.6;
                border: 1px solid var(--border-color);
            }

            pre {
                margin: 0;
                white-space: pre-wrap;
                max-height: 300px;
                overflow-y: auto;
            }

            .erro-linha {
                background-color: rgba(255, 0, 0, 0.1);
            }

            #spinner {
                display: none;
                margin-left: 10px;
                color: var(--text-color);
            }

            .button-container {
                margin: 10px 0;
                display: flex;
                gap: 10px;
            }

            button {
                padding: 8px 16px;
                cursor: pointer;
                background-color: #4CAF50;
                color: white;
                border: none;
                border-radius: 4px;
                font-size: 14px;
                transition: background-color 0.3s;
            }

            button:hover:not(:disabled) {
                background-color: #45a049;
            }

            button:disabled {
                background-color: #cccccc;
                cursor: not-allowed;
            }

            #clear-btn {
                background-color: #f44336;
            }

            #clear-btn:hover:not(:disabled) {
                background-color: #d32f2f;
            }

            .error {
                color: #d9534f;
            }

            .success {
                color: #5cb85c;
            }

            .example-code-container {
                background-color: var(--bg-example);
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
                margin: 20px 0;
                border: 1px solid var(--border-color);
            }

            .example-code-header {
                background-color: var(--bg-example-header);
                color: var(--text-example);
                padding: 12px 20px;
                font-size: 14px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-family: monospace;
            }

            .example-code-header .dots {
                display: flex;
                align-items: center;
                gap: 6px;
            }

            .example-pre {
                margin: 0;
                padding: 20px;
                font-family: 'Fira Code', monospace;
                font-size: 15px;
                line-height: 1.6;
                background-color: var(--bg-example);
                color: var(--text-example);
                overflow-x: auto;
                white-space: pre-wrap;
                word-break: break-word;
            }

            .example-output-container {
                background-color: var(--bg-example-header);
                padding: 23px 20px;
                font-family: 'Fira Code', monospace;
                font-size: 14px;
                color: var(--text-example);
                word-break: break-word;
                height: auto;
                min-height: 30px;
                overflow-y: visible;
            }

            .example-output-header {
                color: var(--text-example);
                font-size: 14px;
                font-family: monospace;
                opacity: 0.8;
                line-height: 1;
            }
        </style>
    </head>

    <body>
        <div class="container">
            <div class="editor-container">
                <div class="code-header">
                    <div class="dots">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                    </div>
                    <span>interprete.py</span>
                </div>
                <textarea id="python-editor"># Digite o seu código aqui
    print("Olá, Mundo!")</textarea>
            </div>

            <div class="button-container">
                <button id="run-btn" disabled>Executar (Ctrl+Enter)</button>
                <button id="clear-btn" disabled>Limpar Saída</button>
                <span id="spinner">⏳ Executando...</span>
            </div>

            <div class="output-container">
                <pre id="saida">Carregando interpretador Python...</pre>
            </div>

            <div class="example-code-container">
                <div class="example-code-header">
                    <div class="dots">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                    </div>
                    <span>exemplo.py</span>
                </div>
                <pre class="example-pre"><code>def exemplo():
        print("Olá, mundo!")</code></pre>
                <div class="example-output-container">
                    <div class="example-output-header">Saída:</div>
                    <div class="output">Olá, mundo!</div>
                </div>
            </div>
        </div>

        <button id="toggle-theme">🌙</button>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/matchbrackets.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/edit/closebrackets.min.js"></script>
        <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>

        <script>
            let pyodide, editor;

            const runBtn = document.getElementById("run-btn");
            const clearBtn = document.getElementById("clear-btn");
            const outputEl = document.getElementById("saida");
            const spinner = document.getElementById("spinner");
            const toggleButton = document.getElementById('toggle-theme');
            let isDark = false;

            function toggleTheme() {
                const root = document.documentElement;
                isDark = !isDark;

                root.style.setProperty('--bg-body', isDark ? 'var(--clr-body-dark)' : 'var(--clr-body-light)');
                root.style.setProperty('--bg-main', isDark ? 'var(--clr-main-dark)' : 'var(--clr-main-light)');
                root.style.setProperty('--text-color', isDark ? 'var(--clr-text-dark)' : 'var(--clr-text-light)');
                root.style.setProperty('--border-color', isDark ? 'var(--clr-border-dark)' : 'var(--clr-border-light)');
                root.style.setProperty('--bg-editor', isDark ? 'var(--clr-editor-dark)' : 'var(--clr-editor-light)');
                root.style.setProperty('--bg-header', isDark ? 'var(--clr-header-dark)' : 'var(--clr-header-light)');
                root.style.setProperty('--bg-dots', isDark ? 'var(--clr-dots-dark)' : 'var(--clr-dots-light)');
                root.style.setProperty('--bg-example', isDark ? 'var(--clr-example-bg-dark)' : 'var(--clr-example-bg-light)');
                root.style.setProperty('--bg-example-header', isDark ? 'var(--clr-example-header-dark)' : 'var(--clr-example-header-light)');
                root.style.setProperty('--text-example', isDark ? 'var(--clr-example-text-dark)' : 'var(--clr-example-text-light)');

                toggleButton.textContent = isDark ? '☀️' : '🌙';

                if (editor) {
                    editor.setOption("theme", isDark ? "dracula" : "default");
                }
            }

            async function iniciar() {
                outputEl.textContent = "Carregando o interpretador Python...";
                try {
                    pyodide = await loadPyodide({
                        indexURL: "https://cdn.jsdelivr.net/pyodide/v0.23.4/full/",
                        stdout: msg => {
                            outputEl.textContent += msg;
                            outputEl.scrollTop = outputEl.scrollHeight;
                        },
                        stderr: msg => {
                            outputEl.textContent += msg;
                            outputEl.scrollTop = outputEl.scrollHeight;
                        }
                    });

                    editor = CodeMirror.fromTextArea(document.getElementById("python-editor"), {
                        mode: "python",
                        lineNumbers: true,
                        indentUnit: 4,
                        tabSize: 4,
                        theme: isDark ? "dracula" : "default",
                        smartIndent: true,
                        matchBrackets: true,
                        autoCloseBrackets: true,
                        extraKeys: {
                            "Ctrl-Enter": () => executarCodigo()
                        }
                    });

                    outputEl.textContent = "Pronto! Digite seu código e clique em Executar ou pressione Ctrl+Enter";
                    outputEl.className = "success";
                    runBtn.disabled = false;
                    clearBtn.disabled = false;
                } catch (err) {
                    outputEl.textContent = `Falha ao carregar o interpretador: ${err.message}`;
                    outputEl.className = "error";
                }
            }

            function limparErros() {
                if (editor) {
                    editor.eachLine(line => editor.removeLineClass(line, "background", "erro-linha"));
                }
            }

            async function executarCodigo() {
                limparErros();
                outputEl.textContent = "";
                outputEl.className = "";
                runBtn.disabled = true;
                clearBtn.disabled = true;
                spinner.style.display = "inline";

                try {
                    await pyodide.runPythonAsync(
                        `import sys, io
    sys.stdout = io.StringIO()
    sys.stderr = sys.stdout`
                    );

                    const execPromise = pyodide.runPythonAsync(editor.getValue());
                    const timeout = new Promise((_, reject) => setTimeout(() => {
                        reject(new Error('Tempo de execução excedido (5 segundos)'));
                    }, 5000));

                    await Promise.race([execPromise, timeout]);

                    const out = await pyodide.runPythonAsync('sys.stdout.getvalue()');
                    if (out) {
                        outputEl.textContent = out;
                    } else {
                        outputEl.textContent = "Executado com sucesso (sem saída)";
                        outputEl.className = "success";
                    }
                } catch (err) {
                    outputEl.textContent = `Erro: ${err.message}`;
                    outputEl.className = "error";

                    const lineMatch = err.message.match(/line (\d+)/);
                    const tracebackMatch = err.message.match(/File "<exec>", line (\d+)/);
                    const errorLine = lineMatch ? parseInt(lineMatch[1]) :
                        tracebackMatch ? parseInt(tracebackMatch[1]) : null;

                    if (errorLine && editor) {
                        editor.addLineClass(errorLine - 1, "background", "erro-linha");
                        editor.scrollIntoView({ line: errorLine - 1, ch: 0 }, 100);
                    }
                } finally {
                    runBtn.disabled = false;
                    clearBtn.disabled = false;
                    spinner.style.display = "none";
                }
            }

            function limparSaida() {
                outputEl.textContent = "";
                outputEl.className = "";
                limparErros();
            }

            runBtn.addEventListener("click", executarCodigo);
            clearBtn.addEventListener("click", limparSaida);
            toggleButton.addEventListener('click', toggleTheme);

            iniciar();
        </script>
    </body>
    </html>